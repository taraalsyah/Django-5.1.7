{% load static %}

<aside class="sidebar" id="sidebarid">
  <!-- Sidebar Header with Logo -->
  <div class="sidebar-header">
    <div class="logo-container">
      <div class="logo-icon">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"></path>
        </svg>
      </div>
      <div class="logo-text">
        <h2>SIGAP-IT</h2>
        <p>Ticketing System</p>
      </div>
    </div>
  </div>

  <!-- User Info -->
  <div class="user-info-card">
    <div class="user-details">
      <p class="user-name">{{ user.get_full_name|default:user.username }}</p>
      <p class="user-email">{{ email|truncatechars:20 }}</p>
      <span class="user-role">{{ role|default:"User" }}</span>
    </div>
  </div>

  <!-- Navigation Menu -->
  <nav class="menu" id="siteNav">
    <div class="menu-section">
      <p class="menu-label" id="mainMenuLabel">Main Menu</p>
      <ul>
        <li>
          <a href="{% url 'ticket:dashboard' %}"
            class="menu-item {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
            id="nav-dashboard">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
              <polyline points="9 22 9 12 15 12 15 22"></polyline>
            </svg>
            <span>Dashboard</span>
          </a>
        </li>
        <li>
          <a href="{% url 'ticket:ticket_index' %}"
            class="menu-item {% if request.resolver_match.url_name == 'ticket_index' %}active{% endif %}"
            id="nav-tickets">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            <span>All Tickets</span>
          </a>
        </li>
        {% if request.user.is_superuser or role == 'Admin' %}
        <li>
          <a href="{% url 'ticket:reporting' %}"
            class="menu-item {% if request.resolver_match.url_name == 'reporting' %}active{% endif %}"
            id="nav-reporting">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path>
              <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
            </svg>
            <span>Reporting</span>
          </a>
        </li>
        {% endif %}
        {% if request.user.is_superuser or role == 'Admin' or role == 'Operation' %}
        <li>
          <a href="{% url 'ticket:create_ticket' %}"
            class="menu-item {% if request.resolver_match.url_name == 'create_ticket' %}active{% endif %}"
            id="nav-new-ticket">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"></circle>
              <line x1="12" y1="8" x2="12" y2="16"></line>
              <line x1="8" y1="12" x2="16" y2="12"></line>
            </svg>
            <span>New Ticket</span>
          </a>
        </li>
        {% endif %}

        {% if request.user.is_superuser or role == 'Admin' %}
        <li>
          <a href="{% url 'ticket:user_management' %}"
            class="menu-item {% if request.resolver_match.url_name == 'user_management' %}active{% endif %}"
            id="nav-users">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
            <span>User Management</span>
          </a>
        </li>
        <li>
          <a href="{% url 'ticket:category_management' %}"
            class="menu-item {% if request.resolver_match.url_name == 'category_management' %}active{% endif %}"
            id="nav-category">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="7" height="7" rx="1"></rect>
              <rect x="14" y="3" width="7" height="7" rx="1"></rect>
              <rect x="14" y="14" width="7" height="7" rx="1"></rect>
              <rect x="3" y="14" width="7" height="7" rx="1"></rect>
            </svg>
            <span>Category</span>
          </a>
        </li>
        {% endif %}
      </ul>
    </div>

    <div class="menu-section">
      <p class="menu-label" id="accountLabel">Account</p>
      <ul>
        <li>
          <a href="{% url 'profile' %}"
            class="menu-item {% if request.resolver_match.url_name == 'profile' %}active{% endif %}" id="nav-profile">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <span>My Profile</span>
          </a>
        </li>
        <li>
          <a href="{% url 'security' %}"
            class="menu-item {% if request.resolver_match.url_name == 'security' %}active{% endif %}" id="nav-security">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            <span>Security</span>
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Logout Button -->
  <div class="sidebar-footer">
    <a href="{% url 'logout' %}?next={{ request.path }}" class="logout-btn" id="nav-logout">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
        <polyline points="16 17 21 12 16 7"></polyline>
        <line x1="21" y1="12" x2="9" y2="12"></line>
      </svg>
      <span>Logout</span>
    </a>
  </div>
</aside>